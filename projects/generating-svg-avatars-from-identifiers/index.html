<!doctype html><html lang=en data-theme=light class=h-full><head><script>{const e=localStorage.theme;if(e!==null)document.documentElement.setAttribute("data-theme",e);else{const e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";document.documentElement.setAttribute("data-theme",e)}}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-CXYG0Q9PH0"></script><script>var dnt,doNotTrack=!1;if(!0&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CXYG0Q9PH0")}</script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=stylesheet type=text/css href=https://madebyme.today/stylesheets/output.min.ef73616c18e6dbb7d0c4b06eb168690961d9fa5d5bbd25e9648a55378c8cf04c1e9409e82cd71efe6ba538a047420e54e491653eda9a46327b49414db89ddc6f.css integrity="sha512-73NhbBjm27fQxLBusWhpCWHZ+l1bvSXpZIpVN4yM8EwelAnoLNce/mulOKBHQg5U5JFlPtqaRjJ7SUFNuJ3cbw=="><link rel=stylesheet type=text/css href=https://madebyme.today/stylesheets/syntax/light.min.f8c5af1bbcb050c9a0f9bc73e6a627b23a8825d8537cb416518426e6d791257ade4676cd57fcabcbb1542e43618a986520126eae9a236ba2937a49b8db8968f0.css integrity="sha512-+MWvG7ywUMmg+bxz5qYnsjqIJdhTfLQWUYQm5teRJXreRnbNV/yry7FULkNhiphlIBJurpoja6KTekm424lo8A=="><link rel=stylesheet type=text/css href=https://madebyme.today/stylesheets/syntax/dark.min.e82275a221c102f04ff48a5a0444f4753cd8fe31e437176a94bb4d1f80d0fce5027a1414ad6ad9d0b8ab893f421c6cf15be886ffb228b55cd8cd85399d60ef99.css integrity="sha512-6CJ1oiHBAvBP9IpaBET0dTzY/jHkNxdqlLtNH4DQ/OUCehQUrWrZ0LiriT9CHGzxW+iG/7IotVzYzYU5nWDvmQ=="><link rel=icon href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://madebyme.today/favicons/favicon-16x16-box-light.png><link rel=icon type=image/png sizes=32x32 href=https://madebyme.today/favicons/favicon-32x32-box-light.png><link rel=icon type=image/png sizes=64x64 href=https://madebyme.today/favicons/favicon-64x64-box-light.png><link rel=apple-touch-icon sizes=180x180 href=https://madebyme.today/favicons/favicon-180x180-box-light.png><link rel=stylesheet href=/3rd-party/katex@v0.16.9/katex.min.css><script defer src=/3rd-party/katex@v0.16.9/katex.min.js></script><script defer src=/3rd-party/katex@v0.16.9/contrib/auto-render.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script><link rel=canonical href=https://madebyme.today/projects/generating-svg-avatars-from-identifiers/><link rel=alternate type=application/rss+xml href=https://madebyme.today/index.xml title=MadeByMe><meta name=description content="When you create a new social service on the internet, one of the things you need to think about is how to make a user&rsquo;s
space feel like their own. Services like GitHub, Roll20, or Reddit
generate &mdash; or allow you to generate &mdash; a custom avatar (i.e. Identicons) for your account. Avatar auto-generation
is especially neat, as it does not require any engagement from the user. Let&rsquo;s try to figure that out on our own."><meta name=author content="Kamil Rusin"><meta name=msapplication-TileColor content="#f5f5f5"><meta name=theme-color content="#f5f5f5"><meta name=twitter:dnt content="on"><meta name=title property="og:title" content="Generating SVG Avatars From Identifiers"><meta property="og:description" content="
        
            When you create a new social service on the internet, one of the things you need to think about is how to make a user&rsquo;s
space feel like their own. Services like GitHub, Roll20, or Reddit
generate &mdash; or allow you to generate &mdash; a custom avatar (i.e. Identicons) for your account. Avatar auto-generation
is especially neat, as it does not require any engagement from the user. Let&rsquo;s try to figure that out on our own.
        
    "><meta property="og:type" content="
        article
    "><meta property="og:url" content="https://madebyme.today/projects/generating-svg-avatars-from-identifiers/"><meta name=image property="og:image" content="https://madebyme.today/polaris-1920x1080.webp"><meta name=image property="og:image:secure_url" content="https://madebyme.today/polaris-1920x1080.webp"><meta property="article:section" content="projects"><meta property="article:published_time" content="2024-02-25T14:26:12+01:00"><meta property="article:modified_time" content="2024-02-25T19:45:00+01:00"><meta property="article:author" content="Kamil Rusin"><meta property="og:site_name" content="MadeByMe"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://madebyme.today/polaris-1920x1080.webp"><meta name=twitter:title content="Generating SVG Avatars From Identifiers"><meta name=twitter:description content="When you create a new social service on the internet, one of the things you need to think about is how to make a user’s space feel like their own. Services like GitHub, Roll20, or Reddit generate — or allow you to generate — a custom avatar (i.e. Identicons) for your account. Avatar auto-generation is especially neat, as it does not require any engagement from the user. Let’s try to figure that out on our own."><meta name=twitter:site content="@AreElectrons"><meta name=generator content="Hugo 0.133.0"><title>Generating SVG Avatars From Identifiers - MadeByMe</title>
<script>const themeToColor={light:"#F5F5F5",dark:"#2A303C"},giscusSendMessage=e=>{const t=document.querySelector("iframe.giscus-frame");if(!t)return;t.contentWindow.postMessage({giscus:e},"https://giscus.app")},getTheme=()=>{const e=localStorage.getItem("theme");return e!==null?e:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},setTheme=e=>{localStorage.setItem("theme",e),reloadTheme(e)},reloadTheme=e=>{document.documentElement.setAttribute("data-theme",e),updateThemeCheckboxStatus(),giscusSendMessage({setConfig:{theme:getTheme()}});const t=themeToColor[e];document.querySelector('meta[name="theme-color"]').setAttribute("content",t),document.querySelector('meta[name="msapplication-TileColor"]').setAttribute("content",t)},setUserTheme=e=>{const t=e.checked?"dark":"light";setTheme(t)},updateThemeCheckboxStatus=()=>{const e=document.getElementById("theme-checkbox");e.checked=getTheme()==="dark"};window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{reloadTheme(getTheme())})</script><script>let FF_FOUC_FIX</script></head><body class="h-full flex flex-col"><nav class="navbar justify-between bg-base-100"><div class=navbar-start><div class=dropdown><div tabindex=0 role=button class="btn btn-ghost lg:hidden" aria-label=Menu><svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"/></svg></div><ul tabindex=0 class="menu dropdown-content bg-base-100 rounded-box z-[1] mt-3 w-52 p-2 shadow"><li><a href=https://madebyme.today/blog/ title=Blog class=nav-link>Blog</a></li><li><a href=https://madebyme.today/projects/ title=Projects class=nav-link>Projects</a></li><li><a href=https://jungle.madebyme.today/ title="Welcome to the 🌴 Jungle!" class=nav-link>🌴 Jungle</a></li><li><a href=https://madebyme.today/cv/ title=Resumé class=nav-link>Resumé</a></li></ul></div><a class="btn btn-ghost text-xl flex flex-col text-primary font-bold" href=https://madebyme.today/>MadeByMe</a></div><div><div class="hidden lg:flex"><ul class="menu menu-horizontal px-1"><li><a href=https://madebyme.today/blog/ title=Blog class=nav-link>Blog</a></li><li><a href=https://madebyme.today/projects/ title=Projects class=nav-link>Projects</a></li><li><a href=https://jungle.madebyme.today/ title="Welcome to the 🌴 Jungle!" class=nav-link>🌴 Jungle</a></li><li><a href=https://madebyme.today/cv/ title=Resumé class=nav-link>Resumé</a></li></ul></div><label class="flex cursor-pointer gap-2" aria-label="Change theme"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><path d="M12 1v2m0 18v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2m18 0h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4"/></svg>
<input id=theme-checkbox type=checkbox value=dark aria-label="Change theme" onchange=setUserTheme(this) class="toggle theme-controller bg-primary-500 hover:bg-primary-500 dark:bg-darkmode-primary-500 dark:hover:bg-darkmode-primary-500"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></label></div></nav><main class="grow md:container px-6 !max-w-3xl"><nav class="breadcrumbs text-sm"><script type=application/ld+json>{"@context":"https://schema.org/","@type":"BreadcrumbList","itemListOrder":"ItemListOrderAscending","itemListElement":[{"@context":"https://schema.org/","@type":"ListItem","position":1,"name":"MadeByMe","item":"https://madebyme.today/","url":"https://madebyme.today/projects/generating-svg-avatars-from-identifiers/"},{"@context":"https://schema.org/","@type":"ListItem","position":2,"name":"Projects","item":"https://madebyme.today/projects/","url":"https://madebyme.today/projects/generating-svg-avatars-from-identifiers/"},{"@context":"https://schema.org/","@type":"ListItem","position":3,"name":"Generating SVG Avatars From Identifiers","item":"https://madebyme.today/projects/generating-svg-avatars-from-identifiers/","url":"https://madebyme.today/projects/generating-svg-avatars-from-identifiers/"}]}</script><ul><li><a class=hover:decoration-dashed href=https://madebyme.today/><span>root</span></a></li><li><a class=hover:decoration-dashed href=https://madebyme.today/projects/><span>Projects</span></a></li><li><a class=hover:decoration-dashed href=https://madebyme.today/projects/generating-svg-avatars-from-identifiers/><span>Generating SVG Avatars From Identifiers</span></a></li></ul></nav><article class=entry><script type=application/ld+json>{"@context":"https://schema.org/","@type":"BlogPosting","name":"Generating SVG Avatars From Identifiers","headline":"Generating SVG Avatars From Identifiers | MadeByMe","alternativeHeadline":"Generating SVG Avatars From Identifiers | MadeByMe","url":"https://madebyme.today/projects/generating-svg-avatars-from-identifiers/","datePublished":"2024-02-25T14:26:12+01:00","inLanguage":"en-us","wordCount":2093,"isFamilyFriendly":"true","copyrightYear":"2024","copyrightHolder":{"@context":"https://schema.org/","@type":"Person","givenName":"Kamil","familyName":"Rusin","name":"Kamil Rusin"},"description":"When you create a new social service on the internet, one of the things you need to think about is how to make a user\u0026rsquo;s space feel like their own. Services like GitHub, Roll20, or Reddit generate \u0026mdash; or allow you to generate \u0026mdash; a custom avatar (i.e. Identicons) for your account. Avatar auto-generation is especially neat, as it does not require any engagement from the user. Let\u0026rsquo;s try to figure that out on our own.\n","publisher":{"@context":"https://schema.org/","@type":"Organization","name":"MadeByMe","url":"https://madebyme.today/"},"keywords":["SVG","Rust"],"mainEntityOfPage":"true","articleBody":"When you create a new social service on the internet, one of the things you need to think about is how to make a user\u0026rsquo;s space feel like their own. Services like GitHub, Roll20, or Reddit generate \u0026mdash; or allow you to generate \u0026mdash; a custom avatar (i.e. Identicons) for your account. Avatar auto-generation is especially neat, as it does not require any engagement from the user. Let\u0026rsquo;s try to figure that out on our own.\nStanding on the shoulders of giants This blog post has been inspired by Representing SHA-256 Hashes As Avatars by François Best. I\u0026rsquo;m re-creating ideas presented by François in their article \u0026mdash; with slight modifications \u0026mdash; in Rust. I think this blog post is one of those things which are easier to understand if you\u0026rsquo;d see the end result first. So, for those interested here\u0026rsquo;s a spoiler.\nSpoiler! This is the end result:\nAvatar for identifier \u0026quot;Foo\u0026quot;.\nThe avatar has 24 segments and consists of 24 \u0026lt;path\u0026gt; tags. The coordinates describing paths are static, but their colors are generated from SHA-256 of the identifier.\n1SHA256(\u0026#34;Foo\u0026#34;) == [ 44, 38, 180, 107, 104, 255, 198, 143, 2 249, 155, 69, 60, 29, 48, 65, 52, 3 19, 66, 45, 112, 100, 131, 191, 160, 4 249, 138, 94, 136, 98, 102, 231, 174] 5 6Base64(SHA256(\u0026#34;Foo\u0026#34;)) == LCa0a2j/xo/5m0U8HTBBNBNCLXBkg7+g+YpeiGJm564= The rest of this blog post focuses on translating the byte array into an avatar that looks nice.\nSVG scaffolding Let\u0026rsquo;s think how to prepare the SVG\u0026rsquo;s structure. We know that each segment must be its own \u0026lt;path\u0026gt; element, so we can color them individually with the fill property. Generating annuluses sectors can be challenging \u0026mdash; it would require using two(!) arcs, which is way too much \u0026mdash; instead, we can cheat a little and create overlapping circle sectors. It will make paths simpler and requires only one(!) arc.\nStarting with the \u0026lt;svg\u0026gt; tag we get:\n1\u0026lt;svg viewBox=\u0026#34;-1 -1 2 2\u0026#34; xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34;\u0026gt; 2 \u0026lt;!-- ... --\u0026gt; 3\u0026lt;/svg\u0026gt; Paths generation gets much easier if the center of \u0026ldquo;circles\u0026rdquo; is in $(0, 0)$. We can do that by setting the viewBox property as shown above: top-left corner is $(-1, -1)$, width is $2$, and height is $2$.\nOK. Now we need to create circle sectors. SVG has some tags for constructing basic shapes (like circles, rectangles, or ellipses). Sadly, pizza slices are not considered as \u0026ldquo;basic\u0026rdquo;, so there\u0026rsquo;s no \u0026lt;pizza-slice\u0026gt; to help us here. Instead, we need to use the \u0026lt;path\u0026gt; tag.\nMaking pizza slices \u0026#x1f355; The \u0026lt;path\u0026gt; tag is nice, because it allows you to construct any complex shape. For it to work we need to describe how we want our shape to look like with its special path data syntax. It\u0026rsquo;s fairly complex, but we only need to grasp 4 of its commands:\nthe absolute \u0026ldquo;moveto\u0026rdquo; command \u0026mdash; which establishes a new initial point, the absolute \u0026ldquo;lineto\u0026rdquo; command \u0026mdash; which draws a line from the current point to the given $(x, y)$, the absolute elliptical arc curve command \u0026mdash; which draws an elliptical arc from the current point to the given $(x, y)$, the \u0026ldquo;closepath\u0026rdquo; command \u0026mdash; which ends the current path by connecting it back to its initial point. To start easy, let\u0026rsquo;s consider an example with 4 pizza slices:\n1\u0026lt;svg overflow=\u0026#34;visible\u0026#34; viewBox=\u0026#34;-1 -1 2 2\u0026#34; xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34;\u0026gt; 2 \u0026lt;path d=\u0026#34;M 0,0 L 0,-1 A 1,1,0,0,1,1,0 z\u0026#34; fill=\u0026#34;IndianRed\u0026#34; stroke=\u0026#34;black\u0026#34; stroke-width=\u0026#34;0.01\u0026#34; /\u0026gt; 3 \u0026lt;path d=\u0026#34;M 0,0 L 1,0 A 1,1,0,0,1,0,1 z\u0026#34; fill=\u0026#34;LightCoral\u0026#34; stroke=\u0026#34;black\u0026#34; stroke-width=\u0026#34;0.01\u0026#34; /\u0026gt; 4 \u0026lt;path d=\u0026#34;M 0,0 L 0,1 A 1,1,0,0,1,-1,0 z\u0026#34; fill=\u0026#34;Salmon\u0026#34; stroke=\u0026#34;black\u0026#34; stroke-width=\u0026#34;0.01\u0026#34; /\u0026gt; 5 \u0026lt;path d=\u0026#34;M 0,0 L -1,0 A 1,1,0,0,1,0,-1 z\u0026#34; fill=\u0026#34;DarkSalmon\u0026#34; stroke=\u0026#34;black\u0026#34; stroke-width=\u0026#34;0.01\u0026#34; /\u0026gt; 6\u0026lt;/svg\u0026gt; It renders to:\n$$ r_1 = 1 $$\nNote I added overflow=\u0026quot;visible\u0026quot; to the SVG tag, because \u0026mdash; with a non-zero stroke \u0026mdash; the image is slightly bigger than its viewBox and the stroke lines get cut off at $(-1, 0)$, $(1, 0)$, $(0, 1)$, and $(-1, 0)$. We can see an interesting patter here: coordinates of the \u0026ldquo;lineto\u0026rdquo; command are the same, as the coordinates of the elliptical arc curve command of the previous element.\nOk, but how to divide these slices into halves? \u0026mdash; you may ask.\nTo do that we need to find the points in the middle of the arcs.\n(ax, ay) (bx, by) (cx, cy) (dx, dy) $$ r_1 = 1 $$\nFortunately \u0026mdash; since the circle\u0026rsquo;s middle point is $(0, 0)$ and the arc points are in the middle of their arcs \u0026mdash; we know that the absolute value of their coordinates is the same. So, our diagram simplifies to:\n(a, -a) (a, a) (-a, -a) (-a, a) $$ r_1 = 1 $$\nGreat. \u0026#x1f44c;\nNow we can use the equation of a circle to find the middle points.\n$$ \\begin{aligned} (x - x_0)^2 + (y - y_0)^2 \u0026amp;= r^2 \\\\[0.25em] (a - 0)^2 + (a - 0)^2 \u0026amp;= 1^2 \\\\[0.25em] 2a^2 \u0026amp;= 1 \\\\[0.25em] a^2 \u0026amp;= \\frac{1}{2} \\\\[0.25em] a \u0026amp;= \\sqrt{\\frac{1}{2}} \\end{aligned} $$\nBy adding four more pizza slices we get:\n$$ r_1 = 1 $$\nLayers of pizza The next step is to create additional (smaller) layers of circle sectors. Let\u0026rsquo;s say we want three circles; there\u0026rsquo;re two obvious ways of selecting division points: equal radii, or equal areas. Equal radii is simpler, so let\u0026rsquo;s try this one first.\nIf the outermost circle has a radius of $1$, then the middle circle will have a radius of $0.\\overline{6}$, and the smallest one will have $0.\\overline{3}$.\n$$ r_1 = 1 \\quad\\text{and}\\quad r_2 = 0.\\overline{6} \\quad\\text{and}\\quad r_3 = 0.\\overline{3} $$\nNot that it matters, but the smallest circle is a little too small for my liking. But, before we decide, we need to see circles with equal areas first.\n$$ \\begin{aligned} \\Pi r_1^2 - \\Pi r_2^2 = \\Pi r_2^2 - \\Pi r_3^2 \\quad\u0026amp;\\text{and}\\quad \\Pi r_2^2 - \\Pi r_3^2 = \\Pi r_3^2 \\\\[0.25em] 1 - r_2^2 = r_2^2 - r_3^2 \\quad\u0026amp;\\text{and}\\quad r_2^2 - r_3^2 = r_3^2 \\\\[0.25em] 1 = 2r_2^2 - r_3^2 \\quad\u0026amp;\\text{and}\\quad r_2^2 = 2r_3^2 \\\\[0.25em] 1 = 3r_3^2 \\quad\u0026amp;\\text{and}\\quad r_2^2 = 2r_3^2 \\\\[0.25em] r_3 = \\sqrt{\\frac{1}{3}} \\quad\u0026amp;\\text{and}\\quad r_2 = \\sqrt{\\frac{2}{3}} \\end{aligned} $$\nWhich gives us this avatar:\n$$ r_1 = 1 \\quad\\text{and}\\quad r_2 = \\sqrt{\\frac{2}{3}} \\quad\\text{and}\\quad r_3 = \\sqrt{\\frac{1}{3}} $$\nWhich is also not ideal, but the other way around\u0026hellip; I was tinkering with the radii a bit and I think I found a middle ground with which I\u0026rsquo;m happy.\n$$ r_1 = 1 \\quad\\text{and}\\quad r_2 = \\frac{0.\\overline{6} + \\sqrt{\\frac{2}{3}}}{2} \\quad\\text{and}\\quad r_3 = \\frac{0.\\overline{3} + \\sqrt{\\frac{1}{3}}}{2} $$\nRadii in the circles above are the arithmetic average of the equal radii variant and the equal areas variant.\nWorking with colors With the SVG structure out of the way we can focus on selecting quasi-random colors for the circle segments based on the identifier\u0026rsquo;s hash. SHA-256 hashes have 32 bytes; it\u0026rsquo;s more than we need \u0026mdash; assuming we need a single byte per circle sector \u0026mdash; which gives us another benefit: we can slide in the 4th circle, if we want to.\nFor now though, let\u0026rsquo;s talk about the colors. If we\u0026rsquo;d use HSL, we can split each byte into 4 pieces: 4 bits for hue (since it\u0026rsquo;s the most dominant), 2 bits for saturation, and 2 bits for lightness. Path\u0026rsquo;s fill property accepts any paint value, which basically means we need to format our color to a standard CSS\u0026rsquo;s hue.\n1fn to_color(byte: u8) -\u0026gt; String { 2 let h = byte \u0026gt;\u0026gt; 4; 3 let s = (byte \u0026gt;\u0026gt; 2) \u0026amp; 0x03; 4 let l = byte \u0026amp; 0x03; 5 6 let normalized_h = (h as f32) / 16.0; 7 let normalized_s = (s as f32) / 4.0; 8 let normalized_l = (l as f32) / 4.0; 9 10 let h = 360.0 * normalized_h; 11 let s = 20.0 + 80.0 * normalized_s; 12 let l = 40.0 + 50.0 * normalized_l; 13 14 format!(\u0026#34;hsl({h}, {s}%, {l}%)\u0026#34;) 15} Alright, let\u0026rsquo;s generate an avatar for \u0026quot;foo\u0026quot; and see how it looks like.\nAvatar for \u0026quot;foo\u0026quot;.\nWell, it does not look terrible, but it\u0026rsquo;s not eye-catching either. To be perfectly honest, we should expect something like this; SHA-256 returns (and for that matter all other hash functions too) a quasi-random values. If we convert those raw bytes to fill colors, we\u0026rsquo;ll get quasi-random colors. To make it nicer we need to modify our algorithm slightly; we need to calculate a global theme, if you will, for the avatar, so that a part of circle segments' colors come from that theme. We can do that by folding all hash bytes into a single one with XOR.\n1fn to_color(normalized_theme: f32, byte: u8) -\u0026gt; String { 2 let h = byte \u0026gt;\u0026gt; 4; 3 let s = (byte \u0026gt;\u0026gt; 2) \u0026amp; 0x03; 4 let l = byte \u0026amp; 0x03; 5 6 let normalized_h = (h as f32) / 16.0; 7 let normalized_s = (s as f32) / 4.0; 8 let normalized_l = (l as f32) / 4.0; 9 10 let h = 360.0 * normalized_theme + 120.0 * normalized_h; 11 let s = 20.0 + 80.0 * normalized_s; 12 let l = 40.0 + 50.0 * normalized_l; 13 14 format!(\u0026#34;hsl({h}, {s}%, {l}%)\u0026#34;) 15} 16 17fn calculate_theme(bytes: \u0026amp;[u8]) -\u0026gt; f32 { 18 let theme = bytes.iter() 19 .fold(0u8, |acc, byte| acc ^ byte); 20 (theme as f32) / (u8::MAX as f32) 21} 22 23fn generate_paths(hash: [u8; 32]) { 24 let theme = calculate_theme(\u0026amp;hash); 25 26 let colors = hash.iter() 27 .cloned() 28 .map(|byte| to_color(theme, byte)) 29 .collect::\u0026lt;Vec\u0026lt;_\u0026gt;\u0026gt;(); 30 31 unimplemented!(\u0026#34;Generate SVG paths.\u0026#34;); 32} This code renders:\nAvatar for \u0026quot;foo\u0026quot; with a theme.\nIt looks rather good, if I say so myself. The solution works as it\u0026rsquo;s suppose to: it most probably produces different avatars for different identifiers (hash collisions do happen) and they look acceptable. However, the rings seem to phase into each other \u0026mdash; their colors are too similar. We could experiment with another theme: a ring theme \u0026mdash; which would be a XOR-fold of all bytes that represent a single ring \u0026mdash; and check the results.\n1fn to_color(normalized_theme: f32, normalized_ring_theme: f32, byte: u8) -\u0026gt; String { 2 let h = byte \u0026gt;\u0026gt; 4; 3 let s = (byte \u0026gt;\u0026gt; 2) \u0026amp; 0x03; 4 let l = byte \u0026amp; 0x03; 5 6 let normalized_h = (h as f32) / 16.0; 7 let normalized_s = (s as f32) / 4.0; 8 let normalized_l = (l as f32) / 4.0; 9 10 let h = 360.0 * normalized_theme 11 + 120.0 * normalized_ring_theme 12 + 30.0 * normalized_h; 13 let s = 20.0 + 80.0 * normalized_s; 14 let l = 40.0 + 50.0 * normalized_l; 15 16 format!(\u0026#34;hsl({h}, {s}%, {l}%)\u0026#34;) 17} 18 19fn calculate_theme(bytes: \u0026amp;[u8]) -\u0026gt; f32 { 20 let theme = bytes.iter().fold(0u8, |acc, byte| acc ^ byte); 21 (theme as f32) / (u8::MAX as f32) 22} 23 24fn generate_paths(hash: [u8; 32]) { 25 let theme = calculate_theme(\u0026amp;hash); 26 let ring_themes = hash 27 .windows(8) 28 .map(calculate_theme) 29 .collect::\u0026lt;Vec\u0026lt;_\u0026gt;\u0026gt;(); 30 31 let colors = hash 32 .iter() 33 .cloned() 34 .enumerate() 35 .map(|(idx, byte)| to_color(theme, ring_themes[idx % 8], byte)) 36 .collect::\u0026lt;Vec\u0026lt;_\u0026gt;\u0026gt;(); 37 38 unimplemented!(\u0026#34;Generate SVG paths.\u0026#34;); 39} With the final touch we get:\nAvatar for \u0026quot;foo\u0026quot; with a global theme and a ring theme.\nWhich is exactly the thing that hides in the spoiler block at the top. If you restrained yourself and didn\u0026rsquo;t check it out: congratulations. Now feel free to do so. \u0026#x1f603;\nConclusions Working on this blog post has been an effort I wanted to make to better understand how SVGs work from the inside, as well as, a challenge to reverse-engineer ideas from Representing SHA-256 Hashes As Avatars.\nI\u0026rsquo;m not working on any service which would benefit from these avatars. If I happen to work on one in the future I\u0026rsquo;ll for sure like to try them out. To make this solution easier to re-use in other places, I\u0026rsquo;ve made a Rust crate called svg_avatars, which implements this exact solution. The crate is fairly minimal, so if anyone has any idea on how to enhance it, I\u0026rsquo;d love to hear from you/check out your PRs.\nAs a closing thought, one of the parameters of the absolute elliptical arc curve command is the sweep-flag parameter. It allows you to determine, whether an arc should be a smiley face or a sad face. If the parameter is 1 \u0026mdash; as it is in our case \u0026mdash; then the arc is a sad face. However, if you\u0026rsquo;d flip the flags to be 0, then all arcs become smiley faces\u0026hellip;\nSmiley-face avatar for \u0026quot;foo\u0026quot;.\n\u0026hellip;and the avatar emerges as a spiderweb. Who does not love a single-line-change feature for Spooktober.\n","author":{"@context":"https://schema.org/","@type":"Person","gender":"male","email":"kamil.jakub.rusin@gmail.com","givenName":"Kamil","familyName":"Rusin","name":"Kamil Rusin","jobTitle":"Software Engineer","nationality":{"@context":"https://schema.org/","@type":"Country","name":"PL"},"alumniOf":{"@context":"https://schema.org/","@type":"CollegeOrUniversity","url":"https://www.pk.edu.pl/","name":"The Cracow University of Technology"},"url":"https:\/\/madebyme.today\/"}}</script><script type=application/ld+json>{"@context":"https://schema.org/","@type":"WPHeader","@id":"#article-title","cssSelector":"#article-title"}</script><header class=mt-3><h1 id=article-title class=text-3xl>Generating SVG Avatars From Identifiers</h1></header><footer class="inline-flex gap-1 flex-wrap"><time datetime=2024-02-25T14:26:12>2024/02/25
</time><span class=select-none>·</span>
<span>10 min</span>
<span class=select-none>·</span>
<a class="btn btn-xs" role=button href=https://madebyme.today/tags/rust/>#Rust</a>
<a class="btn btn-xs" role=button href=https://madebyme.today/tags/svg/>#SVG</a></footer><details class="collapse bg-base-200 my-3"><summary class="collapse-title text-lg font-medium">Table Of Contents</summary><div class="collapse-content table-of-contents markdown-body"><nav id=TableOfContents><ul><li><a href=#svg-scaffolding>SVG scaffolding</a><ul><li><a href=#making-pizza-slices-pizza>Making pizza slices &#x1f355;</a></li><li><a href=#layers-of-pizza>Layers of pizza</a></li></ul></li><li><a href=#working-with-colors>Working with colors</a></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></div></details><main class="my-4 markdown-body"><p>When you create a new social service on the internet, one of the things you need to think about is how to make a user&rsquo;s
space feel like their own. Services like <a href=https://github.blog/2013-08-14-identicons/>GitHub</a>, Roll20, or <a href=https://www.reddit.com/r/reddit/comments/vtkmni/introducing_collectible_avatars/>Reddit</a>
generate &mdash; or allow you to generate &mdash; a custom avatar (i.e. <a href=https://en.wikipedia.org/wiki/Identicon>Identicons</a>) for your account. Avatar auto-generation
is especially neat, as it does not require any engagement from the user. Let&rsquo;s try to figure that out on our own.</p><div class="alert alert-info text-left text-text flex flex-col items-start gap-0"><h6 class="text-info-content flex gap-1 items-center !my-0 !text-lg"><span><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004.0 008.716-6.747M12 21a9.004 9.004.0 01-8.716-6.747M12 21c2.485.0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485.0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997.0 017.843 4.582M12 3A8.997 8.997.0 004.157 7.582m15.686.0A11.953 11.953.0 0112 10.5c-2.998.0-5.74-1.1-7.843-2.918m15.686.0A8.959 8.959.0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919.0 0112 16.5c-3.162.0-6.133-.815-8.716-2.247m0 0A9.015 9.015.0 013 12c0-1.605.42-3.113 1.157-4.418"/></svg></span>Standing on the shoulders of giants</h6><div class="collapsible-content w-full"><div class="mt-2 w-full text-base-content markdown-body">This blog post has been inspired by <a href=https://francoisbest.com/posts/2021/hashvatars>Representing SHA-256 Hashes As Avatars</a> by <a href=https://francoisbest.com/>François Best</a>. I&rsquo;m re-creating ideas
presented by François in their article &mdash; with slight modifications &mdash; in <a href=https://madebyme.today/tags/rust/>Rust</a>.</div></div></div><p>I think this blog post is one of those things which are easier to understand if you&rsquo;d see the end result first. So, for
those interested here&rsquo;s a spoiler.</p><details class="collapse collapse-arrow alert alert-spoiler text-left p-0 text-text flex flex-col items-start gap-0"><summary class="collapse-title text-spoiler-content flex gap-1 items-center !my-0 !text-lg">Spoiler!</summary><div class="collapsible-content p-4 w-full"><div class="mt-2 w-full text-base-content markdown-body"><p>This is the end result:</p><figure><style id=figure-svg-1756758309468538064>#figure-svg-1756758309468538064+svg{width:180px;height:180px}</style><svg overflow="visible" viewBox="-1 -1 2 2"><g><path d="M0 0V-1a1 1 0 01.70710677.29289323z" fill="hsl(127.51471, 80%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677-.70710677A1 1 0 011 0z" fill="hsl(127.51471, 40%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 01.70710677.70710677z" fill="hsl(144.38971, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677.70710677A1 1 0 010 1z" fill="hsl(135.01471, 60%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 01-.70710677.70710677z" fill="hsl(135.01471, 60%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677.70710677A1 1 0 01-1 0z" fill="hsl(151.88971, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-1a1 1 0 01.29289323-.70710677z" fill="hsl(146.26471, 40%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677-.70710677A1 1 0 010-1z" fill="hsl(138.76471, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0V-.7415816a.7415816.7415816.0 01.5243774.2172042z" fill="hsl(251.18384, 60%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774-.5243774A.7415816.7415816.0 01.7415816.0z" fill="hsl(239.93384, 60%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H.7415816A.7415816.7415816.0 01.5243774.5243774z" fill="hsl(230.55884, 40%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774.5243774A.7415816.7415816.0 010 .7415816z" fill="hsl(228.68384, 80%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V.7415816A.7415816.7415816.0 01-.5243774.5243774z" fill="hsl(224.93384, 80%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774.5243774A.7415816.7415816.0 01-.7415816.0z" fill="hsl(228.68384, 20%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-.7415816a.7415816.7415816.0 01.2172042-.5243774z" fill="hsl(230.55884, 20%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774-.5243774A.7415816.7415816.0 010-.7415816z" fill="hsl(228.68384, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V-.45534182a.45534182.45534182.0 01.32197526.13336656z" fill="hsl(167.05148, 20%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526-.32197526A.45534182.45534182.0 01.45534182.0z" fill="hsl(172.67648, 20%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0H.45534182A.45534182.45534182.0 01.32197526.32197526z" fill="hsl(168.92648, 80%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526.32197526A.45534182.45534182.0 010 .45534182z" fill="hsl(178.30148, 20%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V.45534182A.45534182.45534182.0 01-.32197526.32197526z" fill="hsl(176.42648, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526.32197526A.45534182.45534182.0 01-.45534182.0z" fill="hsl(180.17648, 20%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-.45534182a.45534182.45534182.0 01.13336656-.32197526z" fill="hsl(185.80148, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526-.32197526A.45534182.45534182.0 010-.45534182z" fill="hsl(183.92648, 20%, 40%)" stroke="#000" stroke-width=".01"/></g></svg><figcaption><p>Avatar for identifier "Foo".</p></figcaption></figure><p>The avatar has 24 segments and consists of 24 <a href=https://www.w3.org/TR/SVG2/paths.html#PathElement><code>&lt;path></code></a> tags. The coordinates describing paths are static, but their
colors are generated from <a href=https://en.wikipedia.org/wiki/SHA-2>SHA-256</a> of the identifier.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a></span><span class=cl>SHA256(&#34;Foo&#34;) == [ 44,  38, 180, 107, 104, 255, 198, 143,
</span></span><span class=line><span class=ln id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a></span><span class=cl>                  249, 155,  69,  60,  29,  48,  65,  52,
</span></span><span class=line><span class=ln id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a></span><span class=cl>                   19,  66,  45, 112, 100, 131, 191, 160,
</span></span><span class=line><span class=ln id=hl-0-4><a class=lnlinks href=#hl-0-4>4</a></span><span class=cl>                  249, 138,  94, 136,  98, 102, 231, 174]
</span></span><span class=line><span class=ln id=hl-0-5><a class=lnlinks href=#hl-0-5>5</a></span><span class=cl>
</span></span><span class=line><span class=ln id=hl-0-6><a class=lnlinks href=#hl-0-6>6</a></span><span class=cl>Base64(SHA256(&#34;Foo&#34;)) == LCa0a2j/xo/5m0U8HTBBNBNCLXBkg7+g+YpeiGJm564=
</span></span></code></pre></div><p>The rest of this blog post focuses on translating the byte array into an avatar that looks <em>nice</em>.</p></div></div></details><h2 id=svg-scaffolding class="my-8 md:my-12 flex items-center justify-center"><hr class="w-1/12 border-neutral shrink-0 hidden md:block"><a class="font-bold text-center w-full md:w-fit mx-4 !no-underline !link-neutral" href=#svg-scaffolding aria-label=Anchor>SVG scaffolding</a><hr class="w-1/12 border-neutral shrink-0 hidden md:block"></h2><p>Let&rsquo;s think how to prepare the SVG&rsquo;s structure. We know that each segment must be its own <a href=https://www.w3.org/TR/SVG2/paths.html#PathElement><code>&lt;path></code></a> element, so we can
color them individually with the <a href=https://www.w3.org/TR/SVG2/painting.html#SpecifyingFillPaint>fill</a> property. Generating annuluses sectors can be challenging &mdash; it would require
using two(!) <a href=https://www.w3.org/TR/SVG2/paths.html#PathDataEllipticalArcCommands>arcs</a>, which is way too much &mdash; instead, we can cheat a little and create overlapping
circle sectors. It will make paths simpler and requires only one(!) arc.</p><p>Starting with the <code>&lt;svg></code> tag we get:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-svg data-lang=svg><span class=line><span class=ln id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a></span><span class=cl><span class=nt>&lt;svg</span> <span class=na>viewBox=</span><span class=s>&#34;-1 -1 2 2&#34;</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.w3.org/2000/svg&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a></span><span class=cl>    <span class=c>&lt;!-- ... --&gt;</span>
</span></span><span class=line><span class=ln id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a></span><span class=cl><span class=nt>&lt;/svg&gt;</span>
</span></span></code></pre></div><p>Paths generation gets much easier if the center of &ldquo;circles&rdquo; is in $(0, 0)$. We can do that by setting the <code>viewBox</code>
property as shown above: top-left corner is $(-1, -1)$, width is $2$, and height is $2$.</p><p>OK. Now we need to create circle sectors. SVG has some tags for constructing <a href=https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Basic_Shapes>basic shapes</a> (like circles, rectangles,
or ellipses). Sadly, pizza slices are <em>not</em> considered as &ldquo;basic&rdquo;, so there&rsquo;s no <code>&lt;pizza-slice></code> to help us here.
Instead, we need to use the <a href=https://www.w3.org/TR/SVG2/paths.html#PathElement><code>&lt;path></code></a> tag.</p><h3 id=making-pizza-slices-pizza class="my-8 md:my-12 flex items-center justify-center"><hr class="w-1/12 border-neutral shrink-0 hidden md:block"><a class="font-bold text-center w-full md:w-fit mx-4 !no-underline !link-neutral" href=#making-pizza-slices-pizza aria-label=Anchor>Making pizza slices &#x1f355;</a><hr class="w-1/12 border-neutral shrink-0 hidden md:block"></h3><p>The <a href=https://www.w3.org/TR/SVG2/paths.html#PathElement><code>&lt;path></code></a> tag is nice, because it allows you to construct any complex shape. For it to work we need to describe how
we want our shape to look like with its special <a href=https://www.w3.org/TR/SVG2/paths.html#PathData>path data</a> syntax. It&rsquo;s fairly complex, but we only need to grasp 4 of
its commands:</p><ul><li>the <a href=https://www.w3.org/TR/SVG2/paths.html#PathDataMovetoCommands>absolute <strong>&ldquo;moveto&rdquo;</strong></a> command &mdash; which establishes a new initial point,</li><li>the <a href=https://www.w3.org/TR/SVG2/paths.html#PathDataLinetoCommands>absolute <strong>&ldquo;lineto&rdquo;</strong></a> command &mdash; which draws a line from the current point to the given
$(x, y)$,</li><li>the <a href=https://www.w3.org/TR/SVG2/paths.html#PathDataEllipticalArcCommands>absolute elliptical arc curve</a> command &mdash; which draws an elliptical arc from the current point to
the given $(x, y)$,</li><li>the <a href=https://www.w3.org/TR/SVG2/paths.html#PathDataClosePathCommand><strong>&ldquo;closepath&rdquo;</strong></a> command &mdash; which ends the current path by connecting it back to its initial
point.</li></ul><p>To start easy, let&rsquo;s consider an example with 4 pizza slices:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-svg data-lang=svg><span class=line><span class=ln id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a></span><span class=cl><span class=nt>&lt;svg</span> <span class=na>overflow=</span><span class=s>&#34;visible&#34;</span> <span class=na>viewBox=</span><span class=s>&#34;-1 -1 2 2&#34;</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.w3.org/2000/svg&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a></span><span class=cl>    <span class=nt>&lt;path</span> <span class=na>d=</span><span class=s>&#34;M 0,0 L 0,-1 A 1,1,0,0,1,1,0 z&#34;</span> <span class=na>fill=</span><span class=s>&#34;IndianRed&#34;</span> <span class=na>stroke=</span><span class=s>&#34;black&#34;</span> <span class=na>stroke-width=</span><span class=s>&#34;0.01&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=ln id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a></span><span class=cl>    <span class=nt>&lt;path</span> <span class=na>d=</span><span class=s>&#34;M 0,0 L 1,0 A 1,1,0,0,1,0,1 z&#34;</span> <span class=na>fill=</span><span class=s>&#34;LightCoral&#34;</span> <span class=na>stroke=</span><span class=s>&#34;black&#34;</span> <span class=na>stroke-width=</span><span class=s>&#34;0.01&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=ln id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a></span><span class=cl>    <span class=nt>&lt;path</span> <span class=na>d=</span><span class=s>&#34;M 0,0 L 0,1 A 1,1,0,0,1,-1,0 z&#34;</span> <span class=na>fill=</span><span class=s>&#34;Salmon&#34;</span> <span class=na>stroke=</span><span class=s>&#34;black&#34;</span> <span class=na>stroke-width=</span><span class=s>&#34;0.01&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=ln id=hl-1-5><a class=lnlinks href=#hl-1-5>5</a></span><span class=cl>    <span class=nt>&lt;path</span> <span class=na>d=</span><span class=s>&#34;M 0,0 L -1,0 A 1,1,0,0,1,0,-1 z&#34;</span> <span class=na>fill=</span><span class=s>&#34;DarkSalmon&#34;</span> <span class=na>stroke=</span><span class=s>&#34;black&#34;</span> <span class=na>stroke-width=</span><span class=s>&#34;0.01&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=ln id=hl-1-6><a class=lnlinks href=#hl-1-6>6</a></span><span class=cl><span class=nt>&lt;/svg&gt;</span>
</span></span></code></pre></div><p>It renders to:</p><figure><style id=figure-svg-1756758309469507877>#figure-svg-1756758309469507877+svg{width:180px;height:180px}</style><svg overflow="visible" viewBox="-1 -1 2 2"><path d="M0 0V-1A1 1 0 011 0z" fill="#cd5c5c" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 010 1z" fill="#f08080" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 01-1 0z" fill="salmon" stroke="#000" stroke-width=".01"/><path d="M0 0H-1A1 1 0 010-1z" fill="#e9967a" stroke="#000" stroke-width=".01"/></svg></figure><p>$$
r_1 = 1
$$</p><div class="alert alert-info text-left text-text flex flex-col items-start gap-0"><h6 class="text-info-content flex gap-1 items-center !my-0 !text-lg"><span><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875.0 112.652 2.652L6.832 19.82a4.5 4.5.0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5.0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"/></svg></span>Note</h6><div class="collapsible-content w-full"><div class="mt-2 w-full text-base-content markdown-body">I added <code>overflow="visible"</code> to the SVG tag, because &mdash; with a non-zero stroke &mdash; the image is <em>slightly</em> bigger than
its <code>viewBox</code> and the stroke lines get cut off at $(-1, 0)$, $(1, 0)$, $(0, 1)$, and $(-1, 0)$.</div></div></div><p>We can see an interesting patter here: coordinates of the <a href=https://www.w3.org/TR/SVG2/paths.html#PathDataLinetoCommands><strong>&ldquo;lineto&rdquo;</strong></a> command are the same, as the
coordinates of the <a href=https://www.w3.org/TR/SVG2/paths.html#PathDataEllipticalArcCommands>elliptical arc curve</a> command of the <em>previous</em> element.</p><p><em>Ok, but how to divide these slices into halves?</em> &mdash; you may ask.</p><p>To do that we need to find the points in the middle of the arcs.</p><figure><style id=figure-svg-1756758309469957798>#figure-svg-1756758309469957798+svg{width:180px;height:180px}</style><svg id="slices-with-points" overflow="visible" viewBox="-1 -1 2 2"><style>#slices-with-points text{font-size:.2px;font-family:var(--bs-font-monospace);fill:var(--bs-body-color);display:inline-block}#slices-with-points circle{fill:var(--bs-body-color);stroke:none}</style><path d="M0 0V-1A1 1 0 011 0z" fill="#cd5c5c" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 010 1z" fill="#f08080" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 01-1 0z" fill="salmon" stroke="#000" stroke-width=".01"/><path d="M0 0H-1A1 1 0 010-1z" fill="#e9967a" stroke="#000" stroke-width=".01"/><circle cx=".70710678118" cy="-.70710678118" r=".03"/><text x=".70710678118" y="-.70710678118" text-anchor="start" dominant-baseline="text-top">(ax, ay)</text><circle cx=".70710678118" cy=".70710678118" r=".03"/><text x=".70710678118" y=".70710678118" text-anchor="start" dominant-baseline="hanging">(bx, by)</text><circle cx="-.70710678118" cy="-.70710678118" r=".03"/><text x="-.70710678118" y="-.70710678118" text-anchor="end" dominant-baseline="text-top">(cx, cy)</text><circle cx="-.70710678118" cy=".70710678118" r=".03"/><text x="-.70710678118" y=".70710678118" text-anchor="end" dominant-baseline="hanging">(dx, dy)</text></svg></figure><p>$$
r_1 = 1
$$</p><p>Fortunately &mdash; since the circle&rsquo;s middle point is $(0, 0)$ and the arc points are in the middle of their arcs &mdash; we
know that the absolute value of their coordinates is the same. So, our diagram simplifies to:</p><figure><style id=figure-svg-1756758309470171437>#figure-svg-1756758309470171437+svg{width:180px;height:180px}</style><svg id="slices-with-same-points" overflow="visible" viewBox="-1 -1 2 2"><style>#slices-with-same-points text{font-size:.2px;font-family:var(--bs-font-monospace);fill:var(--bs-body-color);display:inline-block}#slices-with-same-points circle{fill:var(--bs-body-color);stroke:none}</style><path d="M0 0V-1A1 1 0 011 0z" fill="#cd5c5c" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 010 1z" fill="#f08080" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 01-1 0z" fill="salmon" stroke="#000" stroke-width=".01"/><path d="M0 0H-1A1 1 0 010-1z" fill="#e9967a" stroke="#000" stroke-width=".01"/><circle cx=".70710678118" cy="-.70710678118" r=".03"/><text x=".70710678118" y="-.70710678118" text-anchor="start" dominant-baseline="text-top">(a, -a)</text><circle cx=".70710678118" cy=".70710678118" r=".03"/><text x=".70710678118" y=".70710678118" text-anchor="start" dominant-baseline="hanging">(a, a)</text><circle cx="-.70710678118" cy="-.70710678118" r=".03"/><text x="-.70710678118" y="-.70710678118" text-anchor="end" dominant-baseline="text-top">(-a, -a)</text><circle cx="-.70710678118" cy=".70710678118" r=".03"/><text x="-.70710678118" y=".70710678118" text-anchor="end" dominant-baseline="hanging">(-a, a)</text></svg></figure><p>$$
r_1 = 1
$$</p><p>Great. &#x1f44c;</p><p>Now we can use the equation of a circle to find the middle points.</p><p>$$
\begin{aligned}
(x - x_0)^2 + (y - y_0)^2 &= r^2 \\[0.25em]
(a - 0)^2 + (a - 0)^2 &= 1^2 \\[0.25em]
2a^2 &= 1 \\[0.25em]
a^2 &= \frac{1}{2} \\[0.25em]
a &= \sqrt{\frac{1}{2}}
\end{aligned}
$$</p><p>By adding four more pizza slices we get:</p><figure><style id=figure-svg-1756758309470409412>#figure-svg-1756758309470409412+svg{width:180px;height:180px}</style><svg overflow="visible" viewBox="-1 -1 2 2"><path d="M0 0V-1a1 1 0 01.70710677.29289323z" fill="#cd5c5c" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677-.70710677A1 1 0 011 0z" fill="#f08080" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 01.70710677.70710677z" fill="salmon" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677.70710677A1 1 0 010 1z" fill="#e9967a" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 01-.70710677.70710677z" fill="#ffa07a" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677.70710677A1 1 0 01-1 0z" fill="coral" stroke="#000" stroke-width=".01"/><path d="M0 0H-1a1 1 0 01.29289323-.70710677z" fill="tomato" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677-.70710677A1 1 0 010-1z" fill="#ff4500" stroke="#000" stroke-width=".01"/></svg></figure><p>$$
r_1 = 1
$$</p><h3 id=layers-of-pizza class="my-8 md:my-12 flex items-center justify-center"><hr class="w-1/12 border-neutral shrink-0 hidden md:block"><a class="font-bold text-center w-full md:w-fit mx-4 !no-underline !link-neutral" href=#layers-of-pizza aria-label=Anchor>Layers of pizza</a><hr class="w-1/12 border-neutral shrink-0 hidden md:block"></h3><p>The next step is to create additional (smaller) layers of circle sectors. Let&rsquo;s say we want three circles; there&rsquo;re two
obvious ways of selecting division points: equal radii, or equal areas. Equal radii is simpler, so let&rsquo;s try this one
first.</p><p>If the outermost circle has a radius of $1$, then the middle circle will have a radius of $0.\overline{6}$, and the
smallest one will have $0.\overline{3}$.</p><figure><style id=figure-svg-1756758309470608184>#figure-svg-1756758309470608184+svg{width:180px;height:180px}</style><svg overflow="visible" viewBox="-1 -1 2 2"><path d="M0 0V-1a1 1 0 01.70710677.29289323z" fill="#cd5c5c" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677-.70710677A1 1 0 011 0z" fill="#f08080" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 01.70710677.70710677z" fill="salmon" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677.70710677A1 1 0 010 1z" fill="#e9967a" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 01-.70710677.70710677z" fill="#ffa07a" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677.70710677A1 1 0 01-1 0z" fill="coral" stroke="#000" stroke-width=".01"/><path d="M0 0H-1a1 1 0 01.29289323-.70710677z" fill="tomato" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677-.70710677A1 1 0 010-1z" fill="#ff4500" stroke="#000" stroke-width=".01"/><path d="M0 0V-.6666667a.6666667.6666667.0 01.47140452.19526218z" fill="#ffffe0" stroke="#000" stroke-width=".01"/><path d="M0 0 .47140452-.47140452A.6666667.6666667.0 01.6666667.0z" fill="#fffacd" stroke="#000" stroke-width=".01"/><path d="M0 0H.6666667A.6666667.6666667.0 01.47140452.47140452z" fill="#fafad2" stroke="#000" stroke-width=".01"/><path d="M0 0 .47140452.47140452A.6666667.6666667.0 010 .6666667z" fill="#ffefd5" stroke="#000" stroke-width=".01"/><path d="M0 0V.6666667A.6666667.6666667.0 01-.47140452.47140452z" fill="#ffe4b5" stroke="#000" stroke-width=".01"/><path d="M0 0-.47140452.47140452A.6666667.6666667.0 01-.6666667.0z" fill="#ffdab9" stroke="#000" stroke-width=".01"/><path d="M0 0H-.6666667a.6666667.6666667.0 01.19526218-.47140452z" fill="#eee8aa" stroke="#000" stroke-width=".01"/><path d="M0 0-.47140452-.47140452A.6666667.6666667.0 010-.6666667z" fill="khaki" stroke="#000" stroke-width=".01"/><path d="M0 0V-.33333334a.33333334.33333334.0 01.23570226.09763108z" fill="#3cb371" stroke="#000" stroke-width=".01"/><path d="M0 0 .23570226-.23570226A.33333334.33333334.0 01.33333334.0z" fill="#2e8b57" stroke="#000" stroke-width=".01"/><path d="M0 0H.33333334A.33333334.33333334.0 01.23570226.23570226z" fill="#228b22" stroke="#000" stroke-width=".01"/><path d="M0 0 .23570226.23570226A.33333334.33333334.0 010 .33333334z" fill="green" stroke="#000" stroke-width=".01"/><path d="M0 0V.33333334A.33333334.33333334.0 01-.23570226.23570226z" fill="#006400" stroke="#000" stroke-width=".01"/><path d="M0 0-.23570226.23570226A.33333334.33333334.0 01-.33333334.0z" fill="#9acd32" stroke="#000" stroke-width=".01"/><path d="M0 0H-.33333334a.33333334.33333334.0 01.09763108-.23570226z" fill="#6b8e23" stroke="#000" stroke-width=".01"/><path d="M0 0-.23570226-.23570226A.33333334.33333334.0 010-.33333334z" fill="olive" stroke="#000" stroke-width=".01"/></svg></figure><p>$$
r_1 = 1
\quad\text{and}\quad
r_2 = 0.\overline{6}
\quad\text{and}\quad
r_3 = 0.\overline{3}
$$</p><p>Not that it matters, but the smallest circle is a little <em>too</em> small for my liking. But, before we decide, we need to
see circles with equal areas first.</p><p>$$
\begin{aligned}
\Pi r_1^2 - \Pi r_2^2 = \Pi r_2^2 - \Pi r_3^2
\quad&\text{and}\quad
\Pi r_2^2 - \Pi r_3^2 = \Pi r_3^2 \\[0.25em]
1 - r_2^2 = r_2^2 - r_3^2
\quad&\text{and}\quad
r_2^2 - r_3^2 = r_3^2 \\[0.25em]
1 = 2r_2^2 - r_3^2
\quad&\text{and}\quad
r_2^2 = 2r_3^2 \\[0.25em]
1 = 3r_3^2
\quad&\text{and}\quad
r_2^2 = 2r_3^2 \\[0.25em]
r_3 = \sqrt{\frac{1}{3}}
\quad&\text{and}\quad
r_2 = \sqrt{\frac{2}{3}}
\end{aligned}
$$</p><p>Which gives us this avatar:</p><figure><style id=figure-svg-1756758309470825300>#figure-svg-1756758309470825300+svg{width:180px;height:180px}</style><svg overflow="visible" viewBox="-1 -1 2 2"><path d="M0 0V-1a1 1 0 01.70710677.29289323z" fill="#cd5c5c" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677-.70710677A1 1 0 011 0z" fill="#f08080" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 01.70710677.70710677z" fill="salmon" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677.70710677A1 1 0 010 1z" fill="#e9967a" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 01-.70710677.70710677z" fill="#ffa07a" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677.70710677A1 1 0 01-1 0z" fill="coral" stroke="#000" stroke-width=".01"/><path d="M0 0H-1a1 1 0 01.29289323-.70710677z" fill="tomato" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677-.70710677A1 1 0 010-1z" fill="#ff4500" stroke="#000" stroke-width=".01"/><path d="M0 0V-.8164966a.8164966.8164966.0 01.57735026.23914634z" fill="#ffffe0" stroke="#000" stroke-width=".01"/><path d="M0 0 .57735026-.57735026A.8164966.8164966.0 01.8164966.0z" fill="#fffacd" stroke="#000" stroke-width=".01"/><path d="M0 0H.8164966A.8164966.8164966.0 01.57735026.57735026z" fill="#fafad2" stroke="#000" stroke-width=".01"/><path d="M0 0 .57735026.57735026A.8164966.8164966.0 010 .8164966z" fill="#ffefd5" stroke="#000" stroke-width=".01"/><path d="M0 0V.8164966A.8164966.8164966.0 01-.57735026.57735026z" fill="#ffe4b5" stroke="#000" stroke-width=".01"/><path d="M0 0-.57735026.57735026A.8164966.8164966.0 01-.8164966.0z" fill="#ffdab9" stroke="#000" stroke-width=".01"/><path d="M0 0H-.8164966a.8164966.8164966.0 01.23914634-.57735026z" fill="#eee8aa" stroke="#000" stroke-width=".01"/><path d="M0 0-.57735026-.57735026A.8164966.8164966.0 010-.8164966z" fill="khaki" stroke="#000" stroke-width=".01"/><path d="M0 0V-.57735026A.57735026.57735026.0 01.4082483-.4082483z" fill="#3cb371" stroke="#000" stroke-width=".01"/><path d="M0 0 .4082483-.4082483A.57735026.57735026.0 01.57735026.0z" fill="#2e8b57" stroke="#000" stroke-width=".01"/><path d="M0 0H.57735026A.57735026.57735026.0 01.4082483.4082483z" fill="#228b22" stroke="#000" stroke-width=".01"/><path d="M0 0 .4082483.4082483A.57735026.57735026.0 010 .57735026z" fill="green" stroke="#000" stroke-width=".01"/><path d="M0 0V.57735026A.57735026.57735026.0 01-.4082483.4082483z" fill="#006400" stroke="#000" stroke-width=".01"/><path d="M0 0-.4082483.4082483A.57735026.57735026.0 01-.57735026.0z" fill="#9acd32" stroke="#000" stroke-width=".01"/><path d="M0 0H-.57735026A.57735026.57735026.0 01-.4082483-.4082483z" fill="#6b8e23" stroke="#000" stroke-width=".01"/><path d="M0 0-.4082483-.4082483A.57735026.57735026.0 010-.57735026z" fill="olive" stroke="#000" stroke-width=".01"/></svg></figure><p>$$
r_1 = 1
\quad\text{and}\quad
r_2 = \sqrt{\frac{2}{3}}
\quad\text{and}\quad
r_3 = \sqrt{\frac{1}{3}}
$$</p><p>Which is also not ideal, but the other way around&mldr; I was tinkering with the radii a bit and I think I found a <a href=https://en.wikipedia.org/wiki/Arithmetic_mean>middle
ground</a> with which I&rsquo;m happy.</p><figure><style id=figure-svg-1756758309471030243>#figure-svg-1756758309471030243+svg{width:180px;height:180px}</style><svg overflow="visible" viewBox="-1 -1 2 2"><path d="M0 0V-1a1 1 0 01.70710677.29289323z" fill="#cd5c5c" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677-.70710677A1 1 0 011 0z" fill="#f08080" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 01.70710677.70710677z" fill="salmon" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677.70710677A1 1 0 010 1z" fill="#e9967a" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 01-.70710677.70710677z" fill="#ffa07a" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677.70710677A1 1 0 01-1 0z" fill="coral" stroke="#000" stroke-width=".01"/><path d="M0 0H-1a1 1 0 01.29289323-.70710677z" fill="tomato" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677-.70710677A1 1 0 010-1z" fill="#ff4500" stroke="#000" stroke-width=".01"/><path d="M0 0V-.7415816a.7415816.7415816.0 01.5243774.2172042z" fill="#ffffe0" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774-.5243774A.7415816.7415816.0 01.7415816.0z" fill="#fffacd" stroke="#000" stroke-width=".01"/><path d="M0 0H.7415816A.7415816.7415816.0 01.5243774.5243774z" fill="#fafad2" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774.5243774A.7415816.7415816.0 010 .7415816z" fill="#ffefd5" stroke="#000" stroke-width=".01"/><path d="M0 0V.7415816A.7415816.7415816.0 01-.5243774.5243774z" fill="#ffe4b5" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774.5243774A.7415816.7415816.0 01-.7415816.0z" fill="#ffdab9" stroke="#000" stroke-width=".01"/><path d="M0 0H-.7415816a.7415816.7415816.0 01.2172042-.5243774z" fill="#eee8aa" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774-.5243774A.7415816.7415816.0 010-.7415816z" fill="khaki" stroke="#000" stroke-width=".01"/><path d="M0 0V-.45534182a.45534182.45534182.0 01.32197526.13336656z" fill="#3cb371" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526-.32197526A.45534182.45534182.0 01.45534182.0z" fill="#2e8b57" stroke="#000" stroke-width=".01"/><path d="M0 0H.45534182A.45534182.45534182.0 01.32197526.32197526z" fill="#228b22" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526.32197526A.45534182.45534182.0 010 .45534182z" fill="green" stroke="#000" stroke-width=".01"/><path d="M0 0V.45534182A.45534182.45534182.0 01-.32197526.32197526z" fill="#006400" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526.32197526A.45534182.45534182.0 01-.45534182.0z" fill="#9acd32" stroke="#000" stroke-width=".01"/><path d="M0 0H-.45534182a.45534182.45534182.0 01.13336656-.32197526z" fill="#6b8e23" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526-.32197526A.45534182.45534182.0 010-.45534182z" fill="olive" stroke="#000" stroke-width=".01"/></svg></figure><p>$$
r_1 = 1
\quad\text{and}\quad
r_2 = \frac{0.\overline{6} + \sqrt{\frac{2}{3}}}{2}
\quad\text{and}\quad
r_3 = \frac{0.\overline{3} + \sqrt{\frac{1}{3}}}{2}
$$</p><p>Radii in the circles above are the arithmetic average of the equal radii variant and the equal areas variant.</p><h2 id=working-with-colors class="my-8 md:my-12 flex items-center justify-center"><hr class="w-1/12 border-neutral shrink-0 hidden md:block"><a class="font-bold text-center w-full md:w-fit mx-4 !no-underline !link-neutral" href=#working-with-colors aria-label=Anchor>Working with colors</a><hr class="w-1/12 border-neutral shrink-0 hidden md:block"></h2><p>With the SVG structure out of the way we can focus on selecting quasi-random colors for the circle segments based on the
identifier&rsquo;s hash. <a href=https://en.wikipedia.org/wiki/SHA-2>SHA-256</a> hashes have 32 bytes; it&rsquo;s more than we need &mdash; assuming we need a single byte
per circle sector &mdash; which gives us another benefit: we can slide in the 4<sup>th</sup> circle, if we want
to.</p><p>For now though, let&rsquo;s talk about the colors. If we&rsquo;d use <a href=https://en.wikipedia.org/wiki/HSL_and_HSV>HSL</a>, we can split each byte into 4 pieces: 4 bits for hue
(since it&rsquo;s the most dominant), 2 bits for saturation, and 2 bits for lightness. Path&rsquo;s <a href=https://www.w3.org/TR/SVG2/painting.html#SpecifyingFillPaint>fill</a> property accepts any
<a href=https://www.w3.org/TR/SVG2/painting.html#SpecifyingPaint>paint</a> value, which basically means we need to format our color to a standard CSS&rsquo;s hue.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=ln id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a></span><span class=cl><span class=k>fn</span> <span class=nf>to_color</span><span class=p>(</span><span class=n>byte</span>: <span class=kt>u8</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>String</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>byte</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=mi>4</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>byte</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0x03</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>byte</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0x03</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>normalized_h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>h</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>16.0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>normalized_s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>s</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>4.0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>normalized_l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>l</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>4.0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>360.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_h</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>20.0</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>80.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_s</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>40.0</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>50.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_l</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a></span><span class=cl><span class=w>    </span><span class=fm>format!</span><span class=p>(</span><span class=s>&#34;hsl(</span><span class=si>{h}</span><span class=s>, </span><span class=si>{s}</span><span class=s>%, </span><span class=si>{l}</span><span class=s>%)&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a></span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Alright, let&rsquo;s generate an avatar for <code>"foo"</code> and see how it looks like.</p><figure><style id=figure-svg-1756758309471292744>#figure-svg-1756758309471292744+svg{width:180px;height:180px}</style><svg overflow="visible" viewBox="-1 -1 2 2"><path d="M0 0V-1a1 1 0 01.70710677.29289323z" fill="hsl(45, 80%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677-.70710677A1 1 0 011 0z" fill="hsl(45, 40%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 01.70710677.70710677z" fill="hsl(247.5, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677.70710677A1 1 0 010 1z" fill="hsl(135, 60%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 01-.70710677.70710677z" fill="hsl(135, 60%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677.70710677A1 1 0 01-1 0z" fill="hsl(337.5, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-1a1 1 0 01.29289323-.70710677z" fill="hsl(270, 40%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677-.70710677A1 1 0 010-1z" fill="hsl(180, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0V-.7415816a.7415816.7415816.0 01.5243774.2172042z" fill="hsl(337.5, 60%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774-.5243774A.7415816.7415816.0 01.7415816.0z" fill="hsl(202.5, 60%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H.7415816A.7415816.7415816.0 01.5243774.5243774z" fill="hsl(90, 40%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774.5243774A.7415816.7415816.0 010 .7415816z" fill="hsl(67.5, 80%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V.7415816A.7415816.7415816.0 01-.5243774.5243774z" fill="hsl(22.5, 80%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774.5243774A.7415816.7415816.0 01-.7415816.0z" fill="hsl(67.5, 20%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-.7415816a.7415816.7415816.0 01.2172042-.5243774z" fill="hsl(90, 20%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774-.5243774A.7415816.7415816.0 010-.7415816z" fill="hsl(67.5, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V-.45534182a.45534182.45534182.0 01.32197526.13336656z" fill="hsl(22.5, 20%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526-.32197526A.45534182.45534182.0 01.45534182.0z" fill="hsl(90, 20%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0H.45534182A.45534182.45534182.0 01.32197526.32197526z" fill="hsl(45, 80%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526.32197526A.45534182.45534182.0 010 .45534182z" fill="hsl(157.5, 20%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V.45534182A.45534182.45534182.0 01-.32197526.32197526z" fill="hsl(135, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526.32197526A.45534182.45534182.0 01-.45534182.0z" fill="hsl(180, 20%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-.45534182a.45534182.45534182.0 01.13336656-.32197526z" fill="hsl(247.5, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526-.32197526A.45534182.45534182.0 010-.45534182z" fill="hsl(225, 20%, 40%)" stroke="#000" stroke-width=".01"/></svg><figcaption><p>Avatar for "foo".</p></figcaption></figure><p>Well, it does not look terrible, but it&rsquo;s not eye-catching either. To be perfectly honest, we should expect something
like this; <a href=https://en.wikipedia.org/wiki/SHA-2>SHA-256</a> returns (and for that matter all other hash functions too) a quasi-random values. If we
convert those <em>raw</em> bytes to fill colors, we&rsquo;ll get quasi-random colors. To make it nicer we need to modify our
algorithm slightly; we need to calculate a global theme, if you will, for the avatar, so that a part of circle segments'
colors come from that theme. We can do that by folding all hash bytes into a single one with XOR.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=ln id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a></span><span class=cl><span class=k>fn</span> <span class=nf>to_color</span><span class=p>(</span><span class=n>normalized_theme</span>: <span class=kt>f32</span><span class=p>,</span><span class=w> </span><span class=n>byte</span>: <span class=kt>u8</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>String</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>byte</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=mi>4</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>byte</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0x03</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>byte</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0x03</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>normalized_h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>h</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>16.0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>normalized_s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>s</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>4.0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>normalized_l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>l</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>4.0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>360.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_theme</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>120.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_h</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>20.0</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>80.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_s</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>40.0</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>50.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_l</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a></span><span class=cl><span class=w>    </span><span class=fm>format!</span><span class=p>(</span><span class=s>&#34;hsl(</span><span class=si>{h}</span><span class=s>, </span><span class=si>{s}</span><span class=s>%, </span><span class=si>{l}</span><span class=s>%)&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a></span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a></span><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>calculate_theme</span><span class=p>(</span><span class=n>bytes</span>: <span class=kp>&amp;</span><span class=p>[</span><span class=kt>u8</span><span class=p>])</span><span class=w> </span>-&gt; <span class=kt>f32</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>theme</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bytes</span><span class=p>.</span><span class=n>iter</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>fold</span><span class=p>(</span><span class=mi>0</span><span class=k>u8</span><span class=p>,</span><span class=w> </span><span class=o>|</span><span class=n>acc</span><span class=p>,</span><span class=w> </span><span class=n>byte</span><span class=o>|</span><span class=w> </span><span class=n>acc</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>byte</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-20><a class=lnlinks href=#hl-3-20>20</a></span><span class=cl><span class=w>    </span><span class=p>(</span><span class=n>theme</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=kt>u8</span>::<span class=no>MAX</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-21><a class=lnlinks href=#hl-3-21>21</a></span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-22><a class=lnlinks href=#hl-3-22>22</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-23><a class=lnlinks href=#hl-3-23>23</a></span><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>generate_paths</span><span class=p>(</span><span class=n>hash</span>: <span class=p>[</span><span class=kt>u8</span><span class=p>;</span><span class=w> </span><span class=mi>32</span><span class=p>])</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-24><a class=lnlinks href=#hl-3-24>24</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>theme</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>calculate_theme</span><span class=p>(</span><span class=o>&amp;</span><span class=n>hash</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-25><a class=lnlinks href=#hl-3-25>25</a></span><span class=cl><span class=w>    
</span></span></span><span class=line><span class=ln id=hl-3-26><a class=lnlinks href=#hl-3-26>26</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>colors</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>hash</span><span class=p>.</span><span class=n>iter</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-27><a class=lnlinks href=#hl-3-27>27</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>cloned</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-28><a class=lnlinks href=#hl-3-28>28</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=n>byte</span><span class=o>|</span><span class=w> </span><span class=n>to_color</span><span class=p>(</span><span class=n>theme</span><span class=p>,</span><span class=w> </span><span class=n>byte</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-29><a class=lnlinks href=#hl-3-29>29</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>collect</span>::<span class=o>&lt;</span><span class=nb>Vec</span><span class=o>&lt;</span><span class=n>_</span><span class=o>&gt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-30><a class=lnlinks href=#hl-3-30>30</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-31><a class=lnlinks href=#hl-3-31>31</a></span><span class=cl><span class=w>    </span><span class=fm>unimplemented!</span><span class=p>(</span><span class=s>&#34;Generate SVG paths.&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-32><a class=lnlinks href=#hl-3-32>32</a></span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>This code renders:</p><figure><style id=figure-svg-1756758309471550726>#figure-svg-1756758309471550726+svg{width:180px;height:180px}</style><svg overflow="visible" viewBox="-1 -1 2 2"><path d="M0 0V-1a1 1 0 01.70710677.29289323z" fill="hsl(133.58824, 80%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677-.70710677A1 1 0 011 0z" fill="hsl(133.58824, 40%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 01.70710677.70710677z" fill="hsl(201.08824, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677.70710677A1 1 0 010 1z" fill="hsl(163.58824, 60%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 01-.70710677.70710677z" fill="hsl(163.58824, 60%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677.70710677A1 1 0 01-1 0z" fill="hsl(231.08824, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-1a1 1 0 01.29289323-.70710677z" fill="hsl(208.58824, 40%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677-.70710677A1 1 0 010-1z" fill="hsl(178.58824, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0V-.7415816a.7415816.7415816.0 01.5243774.2172042z" fill="hsl(231.08824, 60%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774-.5243774A.7415816.7415816.0 01.7415816.0z" fill="hsl(186.08824, 60%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H.7415816A.7415816.7415816.0 01.5243774.5243774z" fill="hsl(148.58824, 40%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774.5243774A.7415816.7415816.0 010 .7415816z" fill="hsl(141.08824, 80%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V.7415816A.7415816.7415816.0 01-.5243774.5243774z" fill="hsl(126.08824, 80%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774.5243774A.7415816.7415816.0 01-.7415816.0z" fill="hsl(141.08824, 20%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-.7415816a.7415816.7415816.0 01.2172042-.5243774z" fill="hsl(148.58824, 20%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774-.5243774A.7415816.7415816.0 010-.7415816z" fill="hsl(141.08824, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V-.45534182a.45534182.45534182.0 01.32197526.13336656z" fill="hsl(126.08824, 20%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526-.32197526A.45534182.45534182.0 01.45534182.0z" fill="hsl(148.58824, 20%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0H.45534182A.45534182.45534182.0 01.32197526.32197526z" fill="hsl(133.58824, 80%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526.32197526A.45534182.45534182.0 010 .45534182z" fill="hsl(171.08824, 20%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V.45534182A.45534182.45534182.0 01-.32197526.32197526z" fill="hsl(163.58824, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526.32197526A.45534182.45534182.0 01-.45534182.0z" fill="hsl(178.58824, 20%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-.45534182a.45534182.45534182.0 01.13336656-.32197526z" fill="hsl(201.08824, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526-.32197526A.45534182.45534182.0 010-.45534182z" fill="hsl(193.58824, 20%, 40%)" stroke="#000" stroke-width=".01"/></svg><figcaption><p>Avatar for "foo" with a theme.</p></figcaption></figure><p>It looks rather good, if I say so myself. The solution works as it&rsquo;s suppose to: it <em>most probably</em> produces different
avatars for different identifiers (<a href=https://en.wikipedia.org/wiki/Hash_collision>hash collisions</a> do happen) and they look acceptable. However, the rings seem to
<em>phase</em> into each other &mdash; their colors are too similar. We could experiment with another theme: a ring theme &mdash; which
would be a XOR-fold of all bytes that represent a single ring &mdash; and check the results.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=ln id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a></span><span class=cl><span class=k>fn</span> <span class=nf>to_color</span><span class=p>(</span><span class=n>normalized_theme</span>: <span class=kt>f32</span><span class=p>,</span><span class=w> </span><span class=n>normalized_ring_theme</span>: <span class=kt>f32</span><span class=p>,</span><span class=w> </span><span class=n>byte</span>: <span class=kt>u8</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>String</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>byte</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=mi>4</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>byte</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0x03</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>byte</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0x03</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>normalized_h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>h</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>16.0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>normalized_s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>s</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>4.0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>normalized_l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>l</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>4.0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>360.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_theme</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a></span><span class=cl><span class=w>        </span><span class=o>+</span><span class=w> </span><span class=mf>120.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_ring_theme</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a></span><span class=cl><span class=w>        </span><span class=o>+</span><span class=w> </span><span class=mf>30.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_h</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>20.0</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>80.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_s</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>40.0</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>50.0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>normalized_l</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a></span><span class=cl><span class=w>    </span><span class=fm>format!</span><span class=p>(</span><span class=s>&#34;hsl(</span><span class=si>{h}</span><span class=s>, </span><span class=si>{s}</span><span class=s>%, </span><span class=si>{l}</span><span class=s>%)&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a></span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a></span><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>calculate_theme</span><span class=p>(</span><span class=n>bytes</span>: <span class=kp>&amp;</span><span class=p>[</span><span class=kt>u8</span><span class=p>])</span><span class=w> </span>-&gt; <span class=kt>f32</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>theme</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bytes</span><span class=p>.</span><span class=n>iter</span><span class=p>().</span><span class=n>fold</span><span class=p>(</span><span class=mi>0</span><span class=k>u8</span><span class=p>,</span><span class=w> </span><span class=o>|</span><span class=n>acc</span><span class=p>,</span><span class=w> </span><span class=n>byte</span><span class=o>|</span><span class=w> </span><span class=n>acc</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>byte</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a></span><span class=cl><span class=w>    </span><span class=p>(</span><span class=n>theme</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=kt>u8</span>::<span class=no>MAX</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>f32</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a></span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-23><a class=lnlinks href=#hl-4-23>23</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-24><a class=lnlinks href=#hl-4-24>24</a></span><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>generate_paths</span><span class=p>(</span><span class=n>hash</span>: <span class=p>[</span><span class=kt>u8</span><span class=p>;</span><span class=w> </span><span class=mi>32</span><span class=p>])</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-25><a class=lnlinks href=#hl-4-25>25</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>theme</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>calculate_theme</span><span class=p>(</span><span class=o>&amp;</span><span class=n>hash</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-26><a class=lnlinks href=#hl-4-26>26</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>ring_themes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>hash</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-27><a class=lnlinks href=#hl-4-27>27</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>windows</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-28><a class=lnlinks href=#hl-4-28>28</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=n>calculate_theme</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-29><a class=lnlinks href=#hl-4-29>29</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>collect</span>::<span class=o>&lt;</span><span class=nb>Vec</span><span class=o>&lt;</span><span class=n>_</span><span class=o>&gt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-30><a class=lnlinks href=#hl-4-30>30</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-31><a class=lnlinks href=#hl-4-31>31</a></span><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>colors</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>hash</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-32><a class=lnlinks href=#hl-4-32>32</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>iter</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-33><a class=lnlinks href=#hl-4-33>33</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>cloned</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-34><a class=lnlinks href=#hl-4-34>34</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>enumerate</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-35><a class=lnlinks href=#hl-4-35>35</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span><span class=w> </span><span class=n>byte</span><span class=p>)</span><span class=o>|</span><span class=w> </span><span class=n>to_color</span><span class=p>(</span><span class=n>theme</span><span class=p>,</span><span class=w> </span><span class=n>ring_themes</span><span class=p>[</span><span class=n>idx</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>8</span><span class=p>],</span><span class=w> </span><span class=n>byte</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-36><a class=lnlinks href=#hl-4-36>36</a></span><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>collect</span>::<span class=o>&lt;</span><span class=nb>Vec</span><span class=o>&lt;</span><span class=n>_</span><span class=o>&gt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-37><a class=lnlinks href=#hl-4-37>37</a></span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-38><a class=lnlinks href=#hl-4-38>38</a></span><span class=cl><span class=w>    </span><span class=fm>unimplemented!</span><span class=p>(</span><span class=s>&#34;Generate SVG paths.&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-39><a class=lnlinks href=#hl-4-39>39</a></span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>With the final touch we get:</p><figure><style id=figure-svg-1756758309471820300>#figure-svg-1756758309471820300+svg{width:180px;height:180px}</style><svg overflow="visible" viewBox="-1 -1 2 2"><path d="M0 0V-1a1 1 0 01.70710677.29289323z" fill="hsl(127.51471, 80%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677-.70710677A1 1 0 011 0z" fill="hsl(127.51471, 40%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 01.70710677.70710677z" fill="hsl(144.38971, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677.70710677A1 1 0 010 1z" fill="hsl(135.01471, 60%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 01-.70710677.70710677z" fill="hsl(135.01471, 60%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677.70710677A1 1 0 01-1 0z" fill="hsl(151.88971, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-1a1 1 0 01.29289323-.70710677z" fill="hsl(146.26471, 40%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677-.70710677A1 1 0 010-1z" fill="hsl(138.76471, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0V-.7415816a.7415816.7415816.0 01.5243774.2172042z" fill="hsl(251.18384, 60%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774-.5243774A.7415816.7415816.0 01.7415816.0z" fill="hsl(239.93384, 60%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H.7415816A.7415816.7415816.0 01.5243774.5243774z" fill="hsl(230.55884, 40%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774.5243774A.7415816.7415816.0 010 .7415816z" fill="hsl(228.68384, 80%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V.7415816A.7415816.7415816.0 01-.5243774.5243774z" fill="hsl(224.93384, 80%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774.5243774A.7415816.7415816.0 01-.7415816.0z" fill="hsl(228.68384, 20%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-.7415816a.7415816.7415816.0 01.2172042-.5243774z" fill="hsl(230.55884, 20%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774-.5243774A.7415816.7415816.0 010-.7415816z" fill="hsl(228.68384, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V-.45534182a.45534182.45534182.0 01.32197526.13336656z" fill="hsl(167.05148, 20%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526-.32197526A.45534182.45534182.0 01.45534182.0z" fill="hsl(172.67648, 20%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0H.45534182A.45534182.45534182.0 01.32197526.32197526z" fill="hsl(168.92648, 80%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526.32197526A.45534182.45534182.0 010 .45534182z" fill="hsl(178.30148, 20%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V.45534182A.45534182.45534182.0 01-.32197526.32197526z" fill="hsl(176.42648, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526.32197526A.45534182.45534182.0 01-.45534182.0z" fill="hsl(180.17648, 20%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-.45534182a.45534182.45534182.0 01.13336656-.32197526z" fill="hsl(185.80148, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526-.32197526A.45534182.45534182.0 010-.45534182z" fill="hsl(183.92648, 20%, 40%)" stroke="#000" stroke-width=".01"/></svg><figcaption><p>Avatar for "foo" with a global theme and a ring theme.</p></figcaption></figure><p>Which is exactly the thing that hides in the spoiler block at the top. If you restrained yourself and didn&rsquo;t check it
out: congratulations. Now feel free to do so. &#x1f603;</p><h2 id=conclusions class="my-8 md:my-12 flex items-center justify-center"><hr class="w-1/12 border-neutral shrink-0 hidden md:block"><a class="font-bold text-center w-full md:w-fit mx-4 !no-underline !link-neutral" href=#conclusions aria-label=Anchor>Conclusions</a><hr class="w-1/12 border-neutral shrink-0 hidden md:block"></h2><p>Working on this blog post has been an effort I wanted to make to better understand how SVGs work from the inside, as
well as, a challenge to reverse-engineer ideas from <a href=https://francoisbest.com/posts/2021/hashvatars>Representing SHA-256 Hashes As Avatars</a>.</p><p>I&rsquo;m not working on any service which would benefit from these avatars. If I happen to work on one in the future I&rsquo;ll for
sure like to try them out. To make this solution easier to re-use in other places, I&rsquo;ve made a Rust crate called
<a href=https://crates.io/crates/svg_avatars><code>svg_avatars</code></a>, which implements this exact solution. The crate is fairly minimal, so if anyone has any idea on how to
enhance it, I&rsquo;d love to hear from you/check out your PRs.</p><p>As a closing thought, one of the parameters of the <a href=https://www.w3.org/TR/SVG2/paths.html#PathDataEllipticalArcCommands>absolute elliptical arc curve</a> command is the
<code>sweep-flag</code> parameter. It allows you to determine, whether an arc should be a smiley face or a sad face. If the
parameter is <code>1</code> &mdash; as it is in our case &mdash; then the arc is a sad face. However, if you&rsquo;d flip the flags to be <code>0</code>,
then all arcs become smiley faces&mldr;</p><figure><style id=figure-svg-1756758309472081839>#figure-svg-1756758309472081839+svg{width:180px;height:180px}</style><svg overflow="visible" viewBox="-1 -1 2 2"><path d="M0 0V-1a1 1 0 00.70710677.29289323z" fill="hsl(127.51471, 80%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677-.70710677A1 1 0 001 0z" fill="hsl(127.51471, 40%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0H1A1 1 0 00.70710677.70710677z" fill="hsl(144.38971, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .70710677.70710677A1 1 0 000 1z" fill="hsl(135.01471, 60%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0V1A1 1 0 00-.70710677.70710677z" fill="hsl(135.01471, 60%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677.70710677A1 1 0 00-1 0z" fill="hsl(151.88971, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-1a1 1 0 00.29289323-.70710677z" fill="hsl(146.26471, 40%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.70710677-.70710677A1 1 0 000-1z" fill="hsl(138.76471, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0V-.7415816a.7415816.7415816.0 00.5243774.2172042z" fill="hsl(251.18384, 60%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774-.5243774A.7415816.7415816.0 00.7415816.0z" fill="hsl(239.93384, 60%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H.7415816A.7415816.7415816.0 00.5243774.5243774z" fill="hsl(230.55884, 40%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .5243774.5243774A.7415816.7415816.0 000 .7415816z" fill="hsl(228.68384, 80%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V.7415816A.7415816.7415816.0 00-.5243774.5243774z" fill="hsl(224.93384, 80%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774.5243774A.7415816.7415816.0 00-.7415816.0z" fill="hsl(228.68384, 20%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-.7415816a.7415816.7415816.0 00.2172042-.5243774z" fill="hsl(230.55884, 20%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.5243774-.5243774A.7415816.7415816.0 000-.7415816z" fill="hsl(228.68384, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V-.45534182a.45534182.45534182.0 00.32197526.13336656z" fill="hsl(167.05148, 20%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526-.32197526A.45534182.45534182.0 00.45534182.0z" fill="hsl(172.67648, 20%, 65%)" stroke="#000" stroke-width=".01"/><path d="M0 0H.45534182A.45534182.45534182.0 00.32197526.32197526z" fill="hsl(168.92648, 80%, 52.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0 .32197526.32197526A.45534182.45534182.0 000 .45534182z" fill="hsl(178.30148, 20%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0V.45534182A.45534182.45534182.0 00-.32197526.32197526z" fill="hsl(176.42648, 40%, 40%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526.32197526A.45534182.45534182.0 00-.45534182.0z" fill="hsl(180.17648, 20%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0H-.45534182a.45534182.45534182.0 00.13336656-.32197526z" fill="hsl(185.80148, 80%, 77.5%)" stroke="#000" stroke-width=".01"/><path d="M0 0-.32197526-.32197526A.45534182.45534182.0 000-.45534182z" fill="hsl(183.92648, 20%, 40%)" stroke="#000" stroke-width=".01"/></svg><figcaption><p><em>Smiley-face</em> avatar for "foo".</p></figcaption></figure><p>&mldr;and the avatar <a href=https://en.wikipedia.org/wiki/Emergence>emerges</a> as a spiderweb. Who does not love a single-line-change feature for Spooktober.</p></main><div class="w-100 flex justify-center my-8"><hr class="md:w-1/4 w-1/2 border-neutral"></div><div class="alert alert-info text-left text-text flex flex-col items-start gap-0"><h6 class="text-info-content flex gap-1 items-center !my-0 !text-lg"><span class=notification-bell><svg class="size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848.0 005.454-1.31A8.967 8.967.0 0118 9.75V9A6 6 0 006 9v.75a8.967 8.967.0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714.0a24.255 24.255.0 01-5.714.0m5.714.0a3 3 0 11-5.714.0"/></svg></span>Interested in my work?</h6><div class="collapsible-content w-full"><div class="mt-2 w-full text-base-content"><p class=text-base-content>Consider subscribing to the
<a href=https://madebyme.today/index.xml class="link link-primary" title="RSS Feed">RSS Feed</a> or
joining my mailing list:
<a href=https://groups.google.com/g/madebyme-notifications class="link link-primary">madebyme-notifications on Google Groups </a>.</p><hr class="my-3 border-neutral-content w-full"><p class="text-sm text-neutral-content"><b>Disclaimer:</b> Only group owner (i.e. me) can view e-mail addresses
of group members. I will not share your e-mail with any third-parties
&mdash; it will be used exclusively to notify you about new blog posts.</p></div></div></div><hr class="my-4 border-neutral opacity-25"><script>let theme=getTheme(),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"nathiss/nathiss.github.io","data-repo-id":"MDEwOlJlcG9zaXRvcnk4MDYyNjk2Ng==","data-category":"Announcements","data-category-id":"DIC_kwDOBM5FFs4CYJcb","data-mapping":"pathname","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":theme,"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([e,t])=>giscusScript.setAttribute(e,t)),document.querySelector("article.entry").appendChild(giscusScript)</script></article></main><footer class="footer footer-center text-base-content p-4"><aside><p>Copyright &copy;
2023&ndash;2025
<span class=text-primary>Kamil</span>
Rusin
/
<a href=/privacy/ class="link link-primary">Privacy</a></p></aside></footer><div id=madebyme-consent-banner class="toast toast-end hidden w-full sm:w-auto min-w-0 sm:min-w-fit"><div class="card bg-base-100 shadow-xl max-w-lg border"><div class="card-body gap-4"><div class="flex justify-between"><h3 class=card-title>Cookies 🍪</h3><button id=close-consent-button class="btn btn-square btn-sm" aria-label=Close><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div class="markdown-body text-sm"><p>This website uses <a href=https://marketingplatform.google.com/about/analytics/>Google Analytics 4</a> to gather data about page views and <a href=https://giscus.app/>Giscus</a> to support article comments.</p><p>This website respects the <a href=https://en.wikipedia.org/wiki/Do_Not_Track>Do Not Track</a> header field. If you do not wish to be tracked by Google Analytics, then please
enable <a href=https://en.wikipedia.org/wiki/Do_Not_Track>Do Not Track</a> for this domain.</p><p>If you wish to know more about data gathered on this website, read <a href=https://madebyme.today/privacy/>About Tracking & Data Collection</a>.</p></div><button id=consent-button class="btn btn-primary text-wrap">I acknowledge, don't show me this again</button></div></div></div><div id=page-progressbar class="fixed top-0 left-0 w-0 h-1 bg-primary-500 dark:bg-darkmode-primary-500 rounded-e-md" role=progressbar aria-valuemin=0 aria-valuenow=0 aria-valuemax=100></div><script>updateThemeCheckboxStatus(),giscusSendMessage({setConfig:{theme:getTheme()}})</script><script>const consentBannerKey="madebyme-given-consent",consentBannerVersion="9b17d89527a0803c9ca685eace5d3ec887d77f4173ad86d2d064b78ebbeb7497";document.getElementById("close-consent-button").addEventListener("click",()=>{document.getElementById("madebyme-consent-banner").classList.add("hidden")}),document.getElementById("consent-button").addEventListener("click",()=>{localStorage.setItem(consentBannerKey,consentBannerVersion),document.getElementById("madebyme-consent-banner").classList.add("hidden")});const localBannerVersion=localStorage.getItem(consentBannerKey);localBannerVersion!==consentBannerVersion&&document.getElementById("madebyme-consent-banner").classList.remove("hidden")</script><script defer>const readingProgressBar={progressBar:document.getElementById("page-progressbar"),update:()=>{const t=document.documentElement.scrollTop,n=document.documentElement.scrollHeight-document.documentElement.clientHeight,e=t/n*100;readingProgressBar.progressBar.setAttribute("aria-valuenow",Math.trunc(e)),readingProgressBar.progressBar.style.width=e+"%"}};document.addEventListener("scroll",readingProgressBar.update);const bodyResizeObserver=new ResizeObserver(e=>{readingProgressBar.update()});bodyResizeObserver.observe(document.body)</script><script type=application/ld+json>{"@context":"https://schema.org/","@type":"Webpage","mainContentOfPage":{"@context":"https://schema.org/","@type":"WebPageElement","cssSelector":"#site-main"},"primaryImageOfPage":"https://madebyme.today/polaris-1920x1080.webp"}</script><script type=application/ld+json>{"@context":"https://schema.org/","@type":"WebSite","name":"MadeByMe","alternateName":"MadeByMe","url":"https://madebyme.today/","description":"I'm Kamil; I work as a software engineer and this is a collection of all things I've been working on in my personal time.","disambiguatingDescription":"I'm Kamil; I work as a software engineer and this is a collection of all things I've been working on in my personal time.","isFamilyFriendly":"true","thumbnailUrl":"https://madebyme.today/favicons/favicon-180x180-box-light.png","image":"https://madebyme.today/favicons/favicon-180x180-box-light.png","inLanguage":"en-us","sameAs":["https://www.madebyme.today","https://www.madebyme.today/","https://madebyme.today","index.xml"],"author":{"@context":"https://schema.org/","@type":"Person","gender":"male","email":"kamil.jakub.rusin@gmail.com","givenName":"Kamil","familyName":"Rusin","name":"Kamil Rusin","jobTitle":"Software Engineer","nationality":{"@context":"https://schema.org/","@type":"Country","name":"PL"},"alumniOf":{"@context":"https://schema.org/","@type":"CollegeOrUniversity","url":"https://www.pk.edu.pl/","name":"The Cracow University of Technology"},"url":"https:\/\/madebyme.today\/"}}</script></body></html>